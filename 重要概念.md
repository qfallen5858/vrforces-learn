> DIS：分布交互仿真（Distributed Interaction Simulation）

> HLA：高层次仿真体系系统（High Level Architecture）

# HLA
HLA是一个可重用的、用于建立基于分布式仿真部件的软件构建，支持由不同仿真部件组成的复杂仿真
## HLA 层次结构
HLA按照面向对象的思想和方法来构建仿真系统，以面向对象分析与设计为基础划分仿真成员、构建仿真联邦

在该结构中，联邦（Federation）是指用于达到某一仿真目的的分布式仿真系统，由若干个相互作用的联邦成员构成。所有参与仿真运行应用程序都可成为联邦成员。联邦成员可以有以下多种类型：
1. 综合控制系统、虚拟兵力生成系统、武器装备仿真系统、数据记录与分析系统等
2. 模拟操作机舱或舱室内的某个分系统，或者舱内的一个设备，都可作为联邦成员
3. 根据不同仿真粒度和不同的仿真聚合度也可以将单兵、班排或营连等分别作为一个联邦成员

上述例子中，联邦成员就是一种仿真应用（Simulation），即使用模型产生联邦中的某一实体的行为。联邦成员由若干相互作用的对象构成，对象是联邦的基本要素。联邦也可以作为另外一个更大的联邦的成员加入其中

## HLA标准
HLA标准包括三个部分，即HLA规则、对象模型模板（Object Model Template,OMT）、接口规范(Interface Specification)
### HLA规则
1. 联邦必须有一个联邦对象模型（Federation Object Model，FOM），其文档必须与OMT一致
2. FOM中的所有对象必须体现在联邦成员中，而不是在RTI（Run-time Infrastructure）中
3. 在联邦运行时，所有联邦成员中FOM的数据交换必须通过RTI
4. 在联邦运行时，联邦成员通RTI的相互作用必须遵循HLA的接口规范说明
5. 在联邦运行时，对象的一个实例的属性，在任何时候只属于一个联邦成员
6. 联邦成员必须有一个仿真对象模型（Simulation Object Model,SOM），其文档必须与OMT一致
7. 联邦成员必须能更新或影响在SOM中的对象的任何属性，并能根据SOM的说明向外发送信息或接收外部信息
8. 在联邦运行时，联邦成员根据SOM的说明，能够动态的转移或接收所拥有的属性
9. 联邦成员能根据SOM的说明，在他们提交更新对象的属性时改变条件
10. 联邦成员能通过某种方式管理本地时间，使他们能协同联邦中的其他成员进行数据交换

### 对象模型模板
OMT定义了FOM、SOM和MOM（Manage Object Model，管理对象模型）。每一个联邦都有其FOM，包括一些可共享的信息。每一个联邦成员都有其SOM，描述了一个联邦成员的重要特征，提供了能供外部使用的对象和交互。MOM是全局定义的，提供了管理一个联邦所需的对象和交互。

OMT以表的形式来描述HLA对象模型。OMT的表结构如下：
1. 对象标识表。提供联邦和联邦对象的主要的标识信息，如对象的名称、版本、创建时间、目的应用域等
2. 对象类结构表。包含了关于对象的子类的层次信息，每个对象类根据其可发布和可利用能力加以分类
3. 交互类结构表。定义了在一个联邦成员中的一个或一组对象所产生的行为，并有可能影响到不同联邦成员中的对象
4. 属性表。定义了仿真域中对象类固定的属性集，其中一部分属性反馈它们的状态，其值可随着时间推移而变化（如实体位置），HLA对象类的属性值的更新情况可通过RTI发布出去
5. 参数表。定义了交互类完整的参数集，包括相应的交互类的参数名、数据类型、优先级、精确度等
6. 路由空间表。记录了数据分发管理控制的基本单位
7. FOM/SOM数据词典。包含了理解OMT表中个数据项所必须的语义信息，数据词典包括表中对象类、交互类、属性和参数的定义

### 接口规范
接口规范是联邦成员和RTI间接口的规范。RTI是一种作为HLA仿真系统提供通用服务的系统软件，它是HLA接口规范说明的软件实现。主要包括以下部件：
1. 联邦执行（FedExec）。用于管理联邦的全局进程。控制联邦成员加入或离开联邦，并协调加入进来的联邦成员的数据交换。每一个运行的联邦必须建立一个联邦执行进程，它是由第一个加入联邦的联邦成员创建的
2. RTI执行（RTIExec）。管理多个联邦执行的创建和终止（加入和退出），保证每个联邦执行具有唯一的标识。运行在一个平台上的全局进程，占用一个公开的端口号，接受来自该端口的各种请求
3. RTI运行库（libRTI）。使HLA的各种服务能被联邦成员所使用，提供了通RTI执行、联邦执行和其他联邦成员进行通信的手段

RTI提供了联邦运行所需的服务
1. 联邦管理（Federation Management）。创建和删除联邦；管理联邦的加入和退出；仿真阶段的控制和同步
2. 声明管理（Declaration Management）。用于发布和说明对象的属性和交互
3. 对象管理（Object Management）。创建和删除对象的实例控制属性和交互的发布
4. 所有权管理（Ownership Management）。转移对象属性的所有权
5. 数据分发管理（Data Distribution）。支持数据间高效的发送
6. 时间管理（Time Management）。协调逻辑时间的推进及通实际时间的关系

# CGF
计算机生成兵力（Computer Generated Force）

在仿真环境中，通过对人类（作战）行为的建模，在不需要人的交互的前提下，由计算机生成和控制，自动地对仿真（战场）环境中的事件和状态做出反应，具备对环境的感知能力、根据地形信息和当前战场态势的变化做出实时决策和任务规划的能力、对战场突发事件的反应能力、智能化地识别目标和攻击目标能力以及与其他实体间的通信能力等，主要用来模拟敌方或友方的战斗实体。

CGF的特点
1. 网络连接和数据协议
2. 综合战场环境仿真
3. 支持多个实体
4. 产生自治行为
5. 行为可由操作员控制
6. 体现军队的结构层次

> SAF：半自动兵力（Semi-Automated Force，SAF）
是指在仿真过程中，高层的决策、规划等行为由人来控制，底层的反应式行为由计算机控制

> AF：自动兵力
主要由计算机来完成对规划、决策等行为的建模

# VR-Forces

## 基于实体参数数据库的实体模型
基于实体参数数据库（Entity Parameters Database，EPD）的实体模型。EPD由实体参数表（Entity Parameters Table，EPT）构成，EPT以结构化的语言描述实体的实例化信息，对实体的组成构建、内部交互关系、外部接口等进行定制。仿真剧情（Scenario）对战场环境和对抗推演过程进行剧情描述，其中包含了虚拟兵力的配置和初始状态信息。静态类库（Class Library）提供创建实体及其构建的模板。实体及其构建的构造基于抽象工厂模式，一种对象类型相当于与一种产品，对应有一种工厂提供创建服务。在实体的构造过程中：剧情给出需求；静态类库提供资源；实体参数数据库提出要求；工厂负责具体实施。

EPD提供了实体构建尤其是其行为组件的配置入口，从而使得实体的能力是可动态调整的。EPD为实体参数入口的集合，入口是由对象类型、地址构成的二元组。对象类型映射了静态类库中对应的对象模板；入口地址映射了EPT。
```
EPD::={EPT_Entry}
EPT_Entry::=<Object_type,Entry_address>
```
EPT是由行为框架、服务组件、资源集、性能构成的四元组
```
EPT::=<Behavior_framework,Service_components,Resource_set,Capability_set>
```
服务组件（Service Components），是有状态池、网络接口、行为组件管理器、资源管理器、任务管理器构成的五元组。其中，状态池（State Repository）封装实体的属性，实体因其种类的不同需要配置不同类型的状态池对象。网络接口（Network Interface）实现实体状态的网络发布。行为组件管理器（Behavior Component Manager）维护了一个行为组件链表，并管理行为组件的仿真调度和组件间的数据通信。资源管理器（Resource Manager）维护实体的资源，如油、弹药等，并提供接口修改、查询资源的种类和数量。任务管理器（Task Manager）为任务执行的管理机构，其主要功能为：响应操作员、上级实体的任务请求；汇报任务进展情况；任务协调，如当一个实体被消灭时，由其任务管理器将剩余任务移交打其他实体
```
Service_components::=<State_repository,Network_interface,Behavior_component_manager,Resource_manager,Task_manager>
```
资源集（Resource Set），是资源的集合，资源由类型和数量两个参数描述
```
Resource_set::={Resource}
Resource::=<Resource_type,Resource_amount>
```
性能集（Capability Set）是性能的集合。性能指的是最大航程、最大速度、转弯半径、升限等极限参数，对实体的行为有制约作用，是类型、值构成的二元组
```
Capability_set::={Capability}
Capability::=<Capability_type,Capability_value>
```
行为框架（Behavior framework）是传感器（Sensors）、控制器（Controllers）、动作执行器（Actuators）、连接关系（Connections）构成的四元组，是定制实体仿真行为的入口。行为组件的通信通过端口实现，由连接关系描述。
```
Behavior_components::=<Sensor_set, Controller_set, Actuator_set, Connection_set>
Sensor_set::={Sensor}
Controller_set::={Controller}
Actuator_set::={Actuator}
Sensor|Controller|Actuator::=<Object_type,Input_port_set,Output_port_set>
Input_pot_set|Output_port_set:={Port}
Connection_set::={Connection}
Connection::=<Input_port,Output_port>
```
## 实体的行为仿真框架
实体的行为分为内在行为和外在行为：内在行为指实体的意识活动，包括推理、决策、规划等；外在行为指能够被其他参与者观察到的动作，表现为与环境发生交互、改变自身状态等。外在行为由内在行为驱动，内在行为为外在行为提供解释。

- 传感器（sensor）、控制器（controller）以及控制器的内部组件（推理器、决策器、规划器、控制单元）、动作执行器（Actuators）都存在数据交互
- 组件之间通过端口（port）实现数据交换。端口分为输入端口（Input port）和输出端口（Output port），提供数据的组件通过输出端口发送数据，数据消费者通过输入端口接收数据。
- 一个组件可以拥有多个输入、输出端口，端口可以用于传递数据包
- 为了确保某个时刻一个输入端口只能从一个输出端口接收数据，在输入、输出端口中引入一个连接优先级。优先级表明了组件输出信息在某种态势下的重要性

在一个仿真帧周期，通过行为组件管理器的调度，组件间的数据通信包含如下步骤：
1. 确定连接优先级。行为组件具有根据实体信念、意图调整其输出端口连接优先级的能力，以竞争成为数据供给者
2. 建立连接。输出端口总是试图与其消费者建立连接，优先级最高的将获得连接权
3. 数据传输。输出端口获得连接权后，其组件生产数据，并打包、发送